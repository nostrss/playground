---
title: [Book] 쏙쏙 들어오는 함수형 코딩 2
description: Ch 2. 현실에서의 함수형 사고
date: 2024-07-22
tags: 함수형 functional 쏙쏙 책 book 개발서적
---


## 챕터 2.현실에서의 함수형 사고 

### 토니 피자에 오신것을 환영합니다.

필자는 토니 피자 가게에서 자바스크립트로 된 로봇이 피자를 만든다는 가정하에 설명을 이어간다.

그리고 여기서 2가지 함수형 사고의 기술을 제시한다. 

그래서 책의 내용도 아래와 같이 2개의 파트로 구성되어 있다고 한다.

> 파트1: 액션과 계산, 데이터
- 코드를 `액션`, `계산`, `데이터`로 구분하고 `계층형 설계`의 원칙에 대해서 알아본다. 

> 파트2: 일급추상
- 가게 주방에는 많은 로봇이 함께 피자를 만드는데 이것은 `분산 시스템`이라고 할 수 있다.
- 이 분산 시스템을 이해하기 위해 `타임라인 다이어그램`을 사용한다.
- 그리고 여러 로봇이 협력할 수 있도록 함수를 인자로 받는 일급 함수를 사용했다.

### 파트1: 액션과 계산 데이터
> 액션
- 호출 횟수, 시점에 의존 하는 것
- 액션은 사용할 때 조심해야한다.

> 계산
- 어떤 것을 결정하거나 계획하는 것
- 계산은 실행해도 다른곳에 영향을 주지 않는다.

> 데이터
- 변경 불가능한 데이터를 가능한 많이 쓰려고 한다.

### 변경 가능성에 따라 코드 나누기
#### 계층화 설계 맛보기

필자는 총 3개의 레이어를 나누어 설명한다.

- 계층 1 - 자주 바뀌는 것 : 비즈니스 규칙
- 계층 2 - 도메인 규칙
- 계층 3 - 자주 바뀌지 않는 것 : 기술스택

각 계층은 아래에 있는 계층을 기반으로 만들어진다.

이런식으로 함수형 프로그래머는 아키텍처 패턴이 계층을 만들기 때문에 `계층형 설계`라고 부른다.

이렇게 계층형 설계로 만든 코드는 테스트, 재사용, 유지보수가 쉽다.

### 파트2: 일급추상
#### 주방을 자동화하기
토니는 얼마 지나지 않아 문제가 생겼다. 

그래서 로봇 1대가 피자를 만들기 위해 수행해야하는 액션을 `타임라인 다이어그램`을 작성했고

이를 통해 액션이 시간의 순서에 따라 어떻게 실행되는지 볼 수 있었다.

#### 분산 시스템을 타임라인으로 시각화하기
토니의 로봇이 피자를 만들고 있지만, 그 속도가 고객들의 요구를 만족시킬 만큼 빠르지 않았다.

왜냐하면 한대의 로봇이 일을 차례대로 진행하고 있었기 때문이다.

그래서 총 3대의 로봇이 함께 만들면 더욱 빨라질 것이라 생각했다.

여러 로봇이 피자를 함께 만드는 것, 이런 것을 분산시스템이라 하는데 이때 타임라인을 잘못 지정하면 엉뚱한 피자가 만들어 질 수 있다.

이 내용은 파트2에서 배울 예정이다.

#### 각각의 타임라인은 다른 순서로 실행됩니다.
분산 시스템에서 서로의 순서를 맞출 수 없는 기능은 없다.

그렇기 때문에 타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행된다.

#### 어려운 경험을 통해 분산 시스템에 대해 배운것
1. 기본적으로 타임라인은 서로 순서를 맞추지 않습니다.

2. 액션이 실행되는 시간은 중용하지 않습니다.

3. 드물지만 타이밍이 어긋나는 경우는 실제 일어난다.

4. 타임라인 다이어그램으로 시스템의 문제를 알 수 있다.

#### 타임라인 커팅: 로봇이 서로를 기다릴 수 있게 하기

토니는 타임라인 커팅이라 부르는 기술을 쓰려고 한다. 이는 17장에서 소개될 예정이다.

타임라인 커팅은 여러 타임라인이 동시에 진행될 때 서로 순서를 맞추는 방법이다.

타임라인 커팅은 고차 동작으로 구현한다고 한다.

#### 좋은 경험을 통해 타임라인에 대해 배운 것

1. 타임라인 커팅으로 서로 다른 작업들을 쉽게 이해 할수 있었다.
2. 타임라인 다이어그램을 사용하면 시간에 따라 진행하는 작업을 쉽게 이해할 수 있었다.
3. 타임라인 다이어그램은 유연하다.







